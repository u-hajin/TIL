> [논리적 데이터 모델링](http://www.kocw.or.kr/home/cview.do?mty=p&kemId=1163794) 강의를 보고 정리합니다.

## 목차

1. [데이터베이스 설계 단계](#데이터베이스-설계-단계)
2. [개념적 데이터 모델링 결과](#개념적-데이터-모델링-결과)
3. [논리적 설계](#논리적-설계)
4. [릴레이션 스키마 변환 규칙](#릴레이션-스키마-변환-규칙)
   - [규칙 1 - 모든 개체는 릴레이션으로 변환](#규칙-1---모든-개체는-릴레이션으로-변환)
   - [규칙 2 - 다대다 관계는 릴레이션으로 변환](#규칙-2---다대다-관계는-릴레이션으로-변환)
   - [규칙 3 - 일대다 관계는 외래키로 표현](#규칙-3---일대다-관계는-외래키로-표현)
     - [규칙 3.1 - 일반적인 일대다 관계는 외래키로 표현](#규칙-31---일반적인-일대다-관계는-외래키로-표현)
     - [규칙 3.2 - 약한 개체가 참여하는 일대다 관계는 외래키를 포함해 기본키 지정](#규칙-32---약한-개체가-참여하는-일대다-관계는-외래키를-포함해-기본키-지정)
   - [규칙 4 - 일대일 관계는 외래키로 표현](#규칙-4---일대일-관계는-외래키로-표현)
     - [규칙 4.1 - 일반적인 일대일 관계는 외래키를 서로 주고 받는다.](#규칙-41---일반적인-일대일-관계는-외래키를-서로-주고-받는다)
     - [규칙 4.2 - 필수적으로 참여하는 개체 릴레이션만 외래키를 받는다.](#규칙-42---필수적으로-참여하는-개체-릴레이션만-외래키를-받는다)
     - [규칙 4.3 - 모든 개체가 필수적으로 참여하면 릴레이션을 하나로 합친다.](#규칙-43---모든-개체가-필수적으로-참여하면-릴레이션을-하나로-합친다)
   - [규칙 5 - 다중 값 속성은 릴레이션으로 변환](#규칙-5---다중-값-속성은-릴레이션으로-변환)
   - [기타 고려 사항](#기타-고려-사항)

## 데이터베이스 설계 단계

<img width="200" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/2384368f-2e78-4364-a75d-58fcbdd4eabc">

$\rightarrow$ E-R 모델과 릴레이션 변환 규칙을 이용한 설계의 과정

설계 과정 중 오류 발견 시 이전 단계로 되돌아가 설계 내용을 변경할 수 있다.

<img width="560" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/24f1c409-8b12-433a-bf19-6ed28e250894">

$\rightarrow$ 데이터베이스 설계 과정의 각 단계별 주요 작업과 결과물

## 개념적 데이터 모델링 결과

<img width="700" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/f40f74c7-f6c0-4da7-9632-6ab48622a753">

$\rightarrow$ 요구 사항 명세서를 개념적 스키마로 작성한 결과

## 논리적 설계

### 목적

- DBMS에 적합한 논리적 스키마 설계
- 개념적 스키마를 논리적 데이터 모델을 이용해 논리적 구조로 표현  
  $\rightarrow$ 논리적 모델링(데이터 모델링)

일반적으로 관계 데이터 모델을 많이 이용

### 결과물

- 논리적 스키마 : 릴레이션 스키마

### 주요 작업

- 개념적 설계 단계의 결과물인 E-R 다이어그램을 릴레이션 스키마로 변환
- 릴레이션 스키마 변환 후 속성의 데이터 타입, 길이, 널값 허용 여부, 기본 값, 제약조건 등을 세부적으로 결정하고 그 결과를 문서화시킴

## 릴레이션 스키마 변환 규칙

- **규칙 1**

  $\rightarrow$ 모든 개체는 릴레이션으로 변환한다.

- **규칙 2**

  $\rightarrow$ 다대다(n:m) 관계는 릴레이션으로 변환한다.

- **규칙 3**

  $\rightarrow$ 일대다(1:n) 관계는 외래키로 표현한다.

- **규칙4**

  $\rightarrow$ 일대일(1:1) 관계는 외래키로 표현한다.

- **규칙 5**

  $\rightarrow$ 다중 값 속성은 릴레이션으로 변환한다.

변환 규칙을 순서대로 적용하되, 해당되지 않는 규칙은 제외한다.

## 규칙 1 - 모든 개체는 릴레이션으로 변환

E-R 다이어그램의 각 개체를 하나의 릴레이션으로 변환

- **개체의 이름** $\rightarrow$ **릴레이션 이름**

- **개체의 속성** $\rightarrow$ **릴레이션의 속성**

- **개체의 키 속성** $\rightarrow$ **릴레이션의 기본키**

- 개체의 속성이 **복합 속성**인 경우, 복합 속성을 구성하고 있는 **단순 속성만 릴레이션의 속성으로 변환**

### 예시 1

<img width="450" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/4f828d39-46e1-4441-87d9-cb2e36c56573">

$\rightarrow$ 개체를 릴레이션으로 변환하는 규칙을 적용한 예

상품(<U>상품번호</U>, 상품명, 재고량, 단가)

### 예시 2 - 복합 속성 가지는 개체 변환

<img width="450" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/03d3f179-b672-4a24-990e-38f0b3bee3d8">

$\rightarrow$ 복합 속성을 가지는 개체를 릴레이션으로 변환하는 예

### 규칙 1 적용 결과

[개념적 데이터 모델링](https://github.com/usuyn/TIL/blob/master/database/fundamentals/conceptual-modeling.md)의 결과물인 [E-R 다이어그램](#개념적-데이터-모델링-결과)에서 상품, 제조업체, 회원, 게시글 개체에 규칙 1을 적용한다.

<img width="500" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/03061bd7-1d6d-487d-b592-685fcead322a">

## 규칙 2 - 다대다 관계는 릴레이션으로 변환

E-R 다이어그램의 다대다 관계를 하나의 릴레이션으로 변환

- **관계의 이름** $\rightarrow$ **릴레이션 이름**

- **관계의 속성** $\rightarrow$ **릴레이션의 속성**

- 관계에 참여하는 개체를 규칙 1에 따라 릴레이션으로 변환 후 **기본키를 관계 릴레이션에 포함**시켜 **외래키로** 지정하고 **외래키들을 조합해 관계 릴레이션의 기본키로** 지정

### 예시

<img width="650" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/6066b458-3b64-45c0-a360-c4aebc8ee42b">

### 규칙 2 적용 결과

[개념적 데이터 모델링](https://github.com/usuyn/TIL/blob/master/database/fundamentals/conceptual-modeling.md)의 결과물인 [E-R 다이어그램](#개념적-데이터-모델링-결과)에서 상품, 회원 개체가 참여하는 주문 관계에 규칙 2를 적용한다.

<img width="500" height="auto" src="https://github.com/usuyn/TIL/assets/68963707/39a3f131-b5fb-42db-9367-091ca38dd2d2">

## 규칙 3 - 일대다 관계는 외래키로 표현

E-R 다이어그램의 일대다 관계는 외래키로만 표현

- **규칙 3.1** **일반적인 일대다 관계는 외래키**로 표현

- **규칙 3.2** **약한 개체가 참여하는 일대다 관계는 외래키를 포함해 기본키**로 지정

### 규칙 3.1 - 일반적인 일대다 관계는 외래키로 표현

- 일대다(1:n) 관계에서 **1측 개체 릴레이션의 기본키를 n측 개체 릴레이션에 포함**시켜 **외래키로** 지정

- **관계의 속성들도 n측 개체 릴레이션**에 포함

### 규칙 3.1 예시

<img width="650" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/489f05c1-6f75-4ac7-b4cf-564998ef81e8">

$\rightarrow$ 일반적인 개체가 참여하는 일대다 관계를 외래키로 표현

### 규칙 3.2 - 약한 개체가 참여하는 일대다 관계는 외래키를 포함해 기본키 지정

- 일대다(1:n) 관계에서 **1측 개체 릴레이션의 기본키를 n측 개체 릴레이션에 포함**시켜 **외래키로** 지정

- **관계의 속성들도 n측 개체 릴레이션**에 포함

- **n측 개체 릴레이션은 외래키를 포함하여 기본키 지정**  
  $\rightarrow$ 약한 개체는 오너 개체에 따라 존재 여부가 결정되므로 **오너 개체의 기본키를 이용해 식별**

### 규칙 3.2 예시

<img width="650" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/b7c409d3-3d63-4f90-94ed-1dca1255b340">

$\rightarrow$ 약한 개체가 참여하는 일대다 관계를 외래키로 표현

### 규칙 3 적용 결과

[개념적 데이터 모델링](https://github.com/usuyn/TIL/blob/master/database/fundamentals/conceptual-modeling.md)의 결과물인 [E-R 다이어그램](#개념적-데이터-모델링-결과)에서 공급(상품, 제조업체 개체 참여), 작성(회원, 게시글 개체 참여) 관계에 규칙 3을 적용한다.

<img width="500" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/67e21e3a-5940-4138-b59e-34714dbe9d42">

## 규칙 4 - 일대일 관계는 외래키로 표현

E-R 다이어그램의 일대일 관계는 외래키로만 표현

- **규칙 4.1** 일반적인 일대일 관계는 외래키를 서로 주고 받는다.

- **규칙 4.2** 일대일 관계에 필수적으로 참여하는 개체의 릴레이션만 외래키를 받는다.

- **규칙 4.3** 모든 개체가 일대일 관계에 필수적으로 참여하면 릴레이션을 하나로 합친다.

### 규칙 4.1 - 일반적인 일대일 관계는 외래키를 서로 주고 받는다.

- 관계에 참여하는 개체 릴레이션들이 서로의 기본키를 주고 받아 외래키로 지정

- 관계의 속성들도 모든 개체 릴레이션에 포함

- 불필요한 데이터 중복이 발생할 수 있음

### 규칙 4.1 예시

<img width="550" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/e9bb260a-5a8e-4cb4-8397-35dc94d7385f">

$\rightarrow$ 일반적인 일대일 관계를 외래키로 표현

### 규칙 4.2 - 필수적으로 참여하는 개체 릴레이션만 외래키를 받는다.

- 관계에 필수적으로 참여하는 개체 릴레이션에만 외래키를 포함

- 관계의 속성들은 관계에 필수적으로 참여하는 개체 릴레이션에 포함

### 규칙 4.2 예시

<img width="550" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/9d657b4f-583c-4d01-9ce0-344eb32fe05a">

$\rightarrow$ 일대일 관계에 필수적으로 참여하는 개체의 릴레이션이 외래키를 가지는 예

### 규칙 4.3 - 모든 개체가 필수적으로 참여하면 릴레이션을 하나로 합친다.

- 관계에 참여하는 개체 릴레이션들을 하나의 릴레이션으로 합쳐서 표현

- 관계의 이름을 릴레이션 이름으로 사용하고 관계에 참여하는 두 개체의 속성들을 관계 릴레이션에 모두 포함

- 두 개체 릴레이션의 키 속성을 조합해 관계 릴레이션의 기본키로 지정

### 규칙 4.3 예시

<img width="550" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/c2e1d1f3-22e1-45d3-8a31-24fb41227c80">

$\rightarrow$ 일대일 관계에 모든 개체가 필수적으로 참여하면 릴레이션을 통합하는 예

## 규칙 5 - 다중 값 속성은 릴레이션으로 변환

E-R 다이어그램의 다중 값 속성은 독립적인 릴레이션으로 변환

- 다중 값 속성과 함께 그 속성을 가지고 있던 개체 릴레이션의 기본키를 외래키로 가져와 새로운 릴레이션에 포함

- 새로운 릴레이션의 기본키는 다중 값 속성과 외래키를 조합해 지정

### 예시

<img width="500" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/0e1a1010-50c9-4722-a33e-f62d1e71cf81">

$\rightarrow$ 다중 값 속성인 부하직원 속성을 그대로 포함하는 사원 릴레이션

사원 릴레이션은 속성에 다중 값을 저장할 수 없는 릴레이션 특성을 위반

<img width="300" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/00893772-e586-4b4d-8d53-de26f0d8c45e">

$\rightarrow$ 릴레이션 특성에 맞게 부하직원 속성을 포함하는 사원 릴레이션

사원 릴레이션은 릴레이션 특성을 위반하지 않지만 사원번호, 사원명, 직위 속성의 값이 불필요하게 중복 저장되는 문제 발생

<img width="550" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/f886e0e1-d1bd-422b-9628-4cdf88214a20">

<img width="500" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/8cd21ac3-3f7c-4f98-a4ea-5622623e4b64">

$\rightarrow$ 규칙 5를 적용한 후의 사원 릴레이션과 사원 - 부하직원 릴레이션

규칙 5에 따라 다중 값 속성을 독립적인 릴레이션으로 변환하면 불필요한 중복을 제거하면서도 릴레이션의 특성을 만족시킬 수 있다.

## 기타 고려 사항

- 모든 관계를 독립적인 릴레이션으로 변환할 수 있다.

  $\rightarrow$ 속성이 많은 관계는 유형에 상관없이 릴레이션으로의 변환을 고려할 수 있음

  <img width="450" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/c97faf4b-75cd-4bc3-86e2-bbc0e86e79f9">

- 개체가 자기 자신과 관계를 맺는 순환 관계도 기본 규칙을 그대로 적용

  <img width="450" alt="image" src="https://github.com/usuyn/TIL/assets/68963707/def02f4b-74f7-4ae9-815f-ef1e4f1c3e3a">
